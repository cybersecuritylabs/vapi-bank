<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FinVault â€” Admin Portal</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:#f1f5f9;color:#1e293b;min-height:100vh}
.layout{display:flex;min-height:100vh}
.sidebar{width:240px;background:#0f172a;color:#fff;padding:1.5rem 0;display:flex;flex-direction:column;position:fixed;top:0;bottom:0}
.sidebar .logo{padding:0 1.25rem;margin-bottom:2rem;display:flex;align-items:center;gap:0.75rem}
.sidebar .logo svg{width:32px;height:32px}
.sidebar .logo h2{font-size:1rem;font-weight:700}
.sidebar .logo span{font-size:0.6875rem;color:#94a3b8;display:block}
.nav-link{display:flex;align-items:center;gap:0.75rem;padding:0.625rem 1.25rem;color:#94a3b8;text-decoration:none;font-size:0.875rem;font-weight:500;transition:all 0.15s;border-left:3px solid transparent}
.nav-link:hover,.nav-link.active{background:rgba(255,255,255,0.05);color:#fff;border-left-color:#2563eb}
.nav-link svg{width:18px;height:18px}
.main{flex:1;margin-left:240px;padding:2rem}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}
.topbar h1{font-size:1.5rem;font-weight:700}
.topbar .role-badge{background:#dbeafe;color:#1d4ed8;padding:0.25rem 0.75rem;border-radius:999px;font-size:0.75rem;font-weight:600}
.card{background:#fff;border-radius:12px;box-shadow:0 1px 3px rgba(0,0,0,0.06);padding:1.5rem;margin-bottom:1.25rem;border:1px solid #e2e8f0}
.card h2{font-size:1rem;font-weight:600;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem}
.card h2 svg{width:18px;height:18px;color:#64748b}
table{width:100%;border-collapse:collapse;font-size:0.875rem}
table th{text-align:left;padding:0.625rem;color:#64748b;font-weight:500;border-bottom:2px solid #e2e8f0;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em}
table td{padding:0.625rem;border-bottom:1px solid #f1f5f9}
.status{display:inline-block;padding:0.125rem 0.5rem;border-radius:999px;font-size:0.75rem;font-weight:600}
.status-published{background:#d1fae5;color:#065f46}
.status-draft{background:#fef3c7;color:#92400e}
.login-wrapper{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#0f172a}
.login-card{background:#fff;border-radius:16px;padding:2.5rem;max-width:400px;width:100%;box-shadow:0 20px 40px rgba(0,0,0,0.3)}
.login-card h1{text-align:center;font-size:1.375rem;margin-bottom:0.25rem}
.login-card p{text-align:center;color:#64748b;font-size:0.875rem;margin-bottom:2rem}
.login-card .logo{text-align:center;margin-bottom:1.5rem}
.login-card .logo svg{width:48px;height:48px}
.form-row{margin-bottom:1rem}
.form-row label{display:block;font-size:0.8125rem;font-weight:500;color:#475569;margin-bottom:0.375rem}
.form-row input{width:100%;padding:0.625rem 0.875rem;border:1.5px solid #e2e8f0;border-radius:8px;font-size:0.875rem;font-family:inherit}
.form-row input:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,0.1)}
.btn{padding:0.625rem 1.25rem;border:none;border-radius:8px;font-size:0.875rem;font-weight:600;cursor:pointer;font-family:inherit;transition:all 0.15s}
.btn-primary{background:#2563eb;color:#fff;width:100%}.btn-primary:hover{background:#1d4ed8}
.btn-sm{padding:0.375rem 0.75rem;font-size:0.75rem}
.btn-danger{background:#ef4444;color:#fff}.btn-danger:hover{background:#dc2626}
.alert{padding:0.75rem;border-radius:8px;font-size:0.8125rem;margin-bottom:1rem;display:none}
.alert-error{background:#fee2e2;color:#991b1b}.alert-success{background:#d1fae5;color:#065f46}
.hidden{display:none!important}
.flag-banner{background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:1rem;border-radius:12px;margin-bottom:1.25rem;font-family:monospace;font-size:0.875rem;word-break:break-all}
.flag-banner strong{display:block;margin-bottom:0.25rem;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.1em;opacity:0.8;font-family:inherit}
</style>
</head>
<body>
<div id="loginView" class="login-wrapper">
  <div class="login-card">
    <div class="logo"><svg viewBox="0 0 48 48" fill="none"><rect width="48" height="48" rx="12" fill="#0f172a"/><path d="M14 14h20v20H14z" fill="none" stroke="#2563eb" stroke-width="2"/><path d="M20 20h8v8h-8z" fill="#2563eb"/></svg></div>
    <h1>FinVault</h1>
    <p>Administration Portal</p>
    <div id="loginAlert" class="alert alert-error"></div>
    <form id="loginForm">
      <div class="form-row"><label>Username</label><input type="text" id="username" required></div>
      <div class="form-row"><label>Password</label><input type="password" id="password" required></div>
      <button type="submit" class="btn btn-primary">Sign In</button>
    </form>
  </div>
</div>

<div id="appView" class="hidden">
  <div class="layout">
    <aside class="sidebar">
      <div class="logo">
        <svg viewBox="0 0 32 32" fill="none"><rect width="32" height="32" rx="8" fill="#1e293b"/><rect x="9" y="9" width="14" height="14" fill="none" stroke="#2563eb" stroke-width="1.5"/><rect x="13" y="13" width="6" height="6" fill="#2563eb"/></svg>
        <div><h2>FinVault</h2><span>Admin Portal</span></div>
      </div>
      <a href="#" class="nav-link active" onclick="showSection('reports')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
        Reports
      </a>
      <a href="#" class="nav-link" onclick="showSection('analytics')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
        Analytics
      </a>
    </aside>
    <div class="main">
      <div class="topbar">
        <h1 id="pageTitle">Reports</h1>
        <div>
          <span class="role-badge" id="roleBadge">analyst</span>
          <button class="btn btn-danger btn-sm" style="margin-left:0.5rem" onclick="doLogout()">Logout</button>
        </div>
      </div>
      <div id="flagBanner"></div>
      <div id="reportsSection">
        <div class="card">
          <h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg> Financial Reports</h2>
          <table><thead><tr><th>Title</th><th>Date</th><th>Status</th></tr></thead><tbody id="reportsBody"></tbody></table>
        </div>
      </div>
      <div id="analyticsSection" class="hidden">
        <div class="card">
          <h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg> Analytics Dashboard</h2>
          <p style="color:#64748b;font-size:0.875rem;">Portfolio performance metrics and risk indicators are updated daily.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const $ = s => document.querySelector(s);
let currentUser = null;

$('#loginForm').addEventListener('submit', async e => {
  e.preventDefault();
  const res = await fetch('/api/auth/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({username:$('#username').value,password:$('#password').value})});
  const data = await res.json();
  if (!res.ok) { $('#loginAlert').textContent=data.error; $('#loginAlert').style.display='block'; return; }
  currentUser = data.user;
  $('#loginView').classList.add('hidden');
  $('#appView').classList.remove('hidden');
  $('#roleBadge').textContent = currentUser.role;
  loadReports();
});

async function loadReports() {
  const res = await fetch('/api/reports');
  const data = await res.json();
  $('#reportsBody').innerHTML = data.reports.map(r =>
    `<tr><td>${r.title}</td><td>${r.date}</td><td><span class="status status-${r.status}">${r.status}</span></td></tr>`
  ).join('');
}

function showSection(name) {
  document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
  event.target.closest('.nav-link').classList.add('active');
  $('#reportsSection').classList.toggle('hidden', name !== 'reports');
  $('#analyticsSection').classList.toggle('hidden', name !== 'analytics');
  $('#pageTitle').textContent = name.charAt(0).toUpperCase() + name.slice(1);
}

function doLogout() {
  fetch('/api/auth/logout',{method:'POST'}).then(()=>{
    $('#appView').classList.add('hidden');
    $('#loginView').classList.remove('hidden');
  });
}
</script>
</body>
</html>
